---
import Layout from '@layouts/Layout.astro';
import AboutSiteTips from '@components/about/AboutSiteTips.astro';
import Author from '@components/about/Author.astro';
import SkillInfo from '@components/about/SkillInfo.astro';
import Maxim from '@components/about/Maxim.astro';
import Single from '@components/about/Single.astro';
import MyInfoAndSayHello from '@components/about/MyInfoAndSayHello.astro';
import { aboutConfig } from '@lib/about';
import { getEntry } from 'astro:content';

const title = "关于我";
const description = "关于钟神秀和ZSXの小站";

// 获取about.mdx内容
const entry = await getEntry('about', 'about');
let AboutContent: any = null;
if (entry) {
  const renderedResult = await entry.render();
  AboutContent = renderedResult.Content;
}
---

<Layout title={title} description={description}>
  <section id="about-page" class="about-page">
    <h1 class="text-3xl font-bold mb-8 text-center">关于我</h1>
    
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <div class="lg:col-span-2 space-y-6">
        <MyInfoAndSayHello 
          author={aboutConfig.author} 
          introduction={aboutConfig.introduction} 
        />
        
        <Maxim maxim={aboutConfig.maxim} />
        
        <SkillInfo skills={aboutConfig.skills} />
        
        <Single>
          {AboutContent && <AboutContent />}
        </Single>
      </div>
      
      <div class="space-y-6">
        <Author author={aboutConfig.author} />
        <AboutSiteTips siteInfo={aboutConfig.siteInfo} />
      </div>
    </div>
  </section>

  <style is:inline>
    /* 关于页面基础样式 */
    .about-page {
      animation: fadeIn 0.6s ease-out;
    }

    /* 技能进度条动画 */
    @keyframes progressBar {
      from { width: 0; }
      to { width: var(--level); }
    }

    .skill-progress {
      --level: attr(data-level);
      animation: progressBar 1s ease-out forwards;
    }

    /* 渐入动画 */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* 卡片悬停效果 */
    .about-site-tips,
    .author-info,
    .skill-info,
    .maxim-section,
    .single-content,
    .my-info-section {
      transition: all 0.3s ease;
    }

    .about-site-tips:hover,
    .author-info:hover,
    .skill-info:hover,
    .maxim-section:hover,
    .single-content:hover,
    .my-info-section:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
    }
  </style>

  <script>
    // 关于页面交互脚本
    document.addEventListener('DOMContentLoaded', () => {
      // 技能进度条动画
      const skillBars = document.querySelectorAll<HTMLElement>('.skill-progress');
      
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const bar = entry.target as HTMLElement;
            const level = bar.getAttribute('data-level');
            if (level) {
              bar.style.width = `${level}%`;
            }
          }
        });
      }, { threshold: 0.1 });
      
      skillBars.forEach(bar => {
        observer.observe(bar);
      });

      // 平滑滚动
      document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
        anchor.addEventListener('click', (e) => {
          e.preventDefault();
          const targetId = anchor.getAttribute('href') || '';
          const target = document.querySelector(targetId);
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        });
      });
    });
  </script>
</Layout>
